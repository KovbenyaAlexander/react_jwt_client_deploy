(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{16:function(e,t,n){e.exports={formWrapper:"Form_formWrapper__3xA_J",buttonsWrapper:"Form_buttonsWrapper__2cuFl",card:"Form_card__1-pdE"}},28:function(e,t,n){e.exports={table:"UsersData_table__k9mXP"}},30:function(e,t,n){e.exports={LoaderWrapper:"Loader_LoaderWrapper__1qszD"}},80:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t),n.d(t,"store",(function(){return ne}));var r=n(0),a=n(10),s=n.n(a),c=n(18),o=n(2),i=n.n(o),u=n(4),l=n(11),p=n(12),d=n(14),f=n.n(d),h="https://fast-ridge-07453.herokuapp.com/api",b=f.a.create({withCredentials:!0,baseURL:h});b.interceptors.request.use((function(e){return e.headers.Authorization=" Bearer ".concat(localStorage.getItem("token")),e})),b.interceptors.response.use((function(e){return e}),function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,401!==t.response.status||!t.config||t.config._isRetry){e.next=14;break}return n._isRetry=!0,e.prev=3,e.next=6,f.a.get("".concat(h,"/refresh"),{withCredentials:!0});case 6:return r=e.sent,localStorage.setItem("token",r.data.accessToken),e.abrupt("return",b.request(n));case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0);case 14:throw t;case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}());var j=b,v=function(){function e(){Object(l.a)(this,e)}return Object(p.a)(e,null,[{key:"login",value:function(){var e=Object(u.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j.post("/login",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"registration",value:function(){var e=Object(u.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j.post("/registration",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j.post("/logout"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"checkAuth",value:function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j.post("/refresh",{refreshToken:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),g="SET_USER",m="SET_AUTH",O="SET_LOADING_STATUS",x="SET_USERS_DATA";function k(e){return{type:m,payload:e}}function w(e){return{type:g,payload:e}}function _(e){return{type:O,payload:e}}var y=n(6),A=n.n(y),T=function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},S=function(e,t){return function(){var n=Object(u.a)(i.a.mark((function n(r){var a,s,c,o,u;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(T(e)){n.next=4;break}return A.a.toast({html:"Invalid email"}),n.abrupt("return");case 4:if(!(t.length<4||t.length>30)){n.next=7;break}return A.a.toast({html:"Too short password"}),n.abrupt("return");case 7:return n.prev=7,r(_(!0)),n.next=11,v.login(e,t);case 11:a=n.sent,localStorage.setItem("token",a.data.accessToken),document.cookie="refreshToken=".concat(a.data.refreshToken),r(k(!0)),r(w(a.data.user)),A.a.toast({html:"login successful"}),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(7),(null===n.t0||void 0===n.t0||null===(s=n.t0.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.message)?A.a.toast({html:null===n.t0||void 0===n.t0||null===(o=n.t0.response)||void 0===o||null===(u=o.data)||void 0===u?void 0:u.message}):A.a.toast("something went wrong");case 22:return n.prev=22,r(_(!1)),n.finish(22);case 25:case"end":return n.stop()}}),n,null,[[7,19,22,25]])})));return function(e){return n.apply(this,arguments)}}()},N=function(e,t){return function(){var n=Object(u.a)(i.a.mark((function n(r){var a,s,c,o,u;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(T(e)){n.next=4;break}return A.a.toast({html:"Invalid email"}),n.abrupt("return");case 4:if(!(t.length<4||t.length>30)){n.next=7;break}return A.a.toast({html:"Too short password"}),n.abrupt("return");case 7:return n.prev=7,r(_(!0)),n.next=11,v.registration(e,t);case 11:a=n.sent,localStorage.setItem("token",a.data.accessToken),document.cookie="refreshToken=".concat(a.data.refreshToken),r(k(!0)),r(w(a.data.user)),A.a.toast({html:"Registration successful"}),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(7),(null===n.t0||void 0===n.t0||null===(s=n.t0.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.message)?A.a.toast({html:null===n.t0||void 0===n.t0||null===(o=n.t0.response)||void 0===o||null===(u=o.data)||void 0===u?void 0:u.message}):A.a.toast("something went wrong");case 22:return n.prev=22,r(_(!1)),n.finish(22);case 25:case"end":return n.stop()}}),n,null,[[7,19,22,25]])})));return function(e){return n.apply(this,arguments)}}()},C=n(8),E=n(16),I=n.n(E),L=n(1),U=Object(C.b)(null,(function(e){return{login:function(t,n){return e(S(t,n))},registration:function(t,n){return e(N(t,n))}}}))((function(e){var t=e.login,n=e.registration,a=Object(r.useState)(""),s=Object(c.a)(a,2),o=s[0],i=s[1],u=Object(r.useState)(""),l=Object(c.a)(u,2),p=l[0],d=l[1];return Object(L.jsxs)("div",{className:I.a.formWrapper,children:[Object(L.jsxs)("div",{className:"input-field col s6 ",children:[Object(L.jsx)("input",{autoComplete:"off",type:"text",id:"email_input",onChange:function(e){return i(e.target.value)},value:o}),Object(L.jsx)("label",{htmlFor:"email_input",children:"Email"})]}),Object(L.jsxs)("div",{className:"input-field col s6 ",children:[Object(L.jsx)("input",{autoComplete:"off",type:"password",id:"passrowd_input",onChange:function(e){return d(e.target.value)},value:p}),Object(L.jsx)("label",{htmlFor:"passrowd_input",children:"Password"})]}),Object(L.jsxs)("div",{className:I.a.buttonsWrapper,children:[Object(L.jsx)("button",{className:"waves-effect btn waves-light btn-small",onClick:function(){return t(o,p)},children:"Login"}),Object(L.jsx)("button",{className:"waves-effect btn waves-light btn-small",onClick:function(){return n(o,p)},children:"Registration"})]}),Object(L.jsx)("p",{})]})})),D=function(){return function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(_(!0)),n=F("refreshToken"),console.log("refrToken--\x3e".concat(n)),e.next=6,v.checkAuth(n);case 6:r=e.sent,localStorage.setItem("token",r.data.accessToken),t(k(!0)),t(w(r.data.user)),t(_(!1)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:return e.prev=16,t(_(!1)),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(t){return e.apply(this,arguments)}}()};function F(e){var t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()}var P=function(){return function(e){e(_(!0));try{v.logout(),localStorage.removeItem("token"),e(k(!1)),e(w({}))}catch(t){console.log(t)}finally{e(_(!1))}}},W=function(){function e(){Object(l.a)(this,e)}return Object(p.a)(e,null,[{key:"getUsers",value:function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j.get("/users"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),B=function(){return function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(_(!0)),e.next=4,W.getUsers();case 4:n=e.sent,t((r=n.data,{type:x,payload:r})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:return e.prev=11,t(_(!1)),e.finish(11);case 14:t(_(!1));case 15:case"end":return e.stop()}var r}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}()},R=n(28),z=n.n(R),Y=Object(C.b)((function(e){return{usersData:e.usersData}}))((function(e){var t=e.usersData;if(!t)return null;var n=t.map((function(e,t){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:e.email}),Object(L.jsx)("td",{children:e.isActivated?"True":"False"})]},t)}));return Object(L.jsxs)("table",{className:"".concat(z.a.table," highlight"),children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"Email"}),Object(L.jsx)("th",{children:"IsEmailConfirmed"})]})}),Object(L.jsx)("tbody",{children:n})]})})),q=n(9),J=n.n(q),G=Object(C.b)((function(e){return{user:e.user}}),(function(e){return{logout:function(){e(P())},getUsersData:function(){e(B())}}}))((function(e){var t=e.user,n=e.getUsersData,r=e.logout;if(t){var a=t.email,s=t.id,c=t.isActivated;return Object(L.jsxs)("div",{className:J.a.Profile,children:[Object(L.jsxs)("div",{className:"card-panel grey lighten-5 z-depth-1 ".concat(J.a.card),children:[Object(L.jsx)("table",{className:"".concat(J.a.table," highlight"),children:Object(L.jsxs)("tbody",{children:[Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:"Your Email"}),Object(L.jsx)("td",{children:a})]}),Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:"Your id"}),Object(L.jsx)("td",{children:s})]}),Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:"Is your email confirmed"}),Object(L.jsx)("td",{children:c?"yes":"no"})]})]})}),Object(L.jsx)("button",{className:"waves-effect btn waves-light btn-small",onClick:r,children:"Logout"})]}),Object(L.jsx)("button",{className:"waves-effect btn waves-light btn-small ".concat(J.a.getUsersBtn),onClick:n,children:"Get users"})]})}return null})),H=n(29),Z=n.n(H),Q=n(30),X=n.n(Q),$=function(){return Object(L.jsx)("div",{className:X.a.LoaderWrapper,children:Object(L.jsx)(Z.a,{type:"BallTriangle",color:"#00BFFF",height:80,width:80})})};n(80);var K=Object(C.b)((function(e){var t,n;return{isLoading:e.isLoading,isAuth:e.isAuth,userEmail:null===(t=e.user)||void 0===t?void 0:t.email,isActivated:null===(n=e.user)||void 0===n?void 0:n.isActivated}}),(function(e){return{checkAuth:function(){e(D())},logout:function(){e(P())},getUsersData:function(){e(B())}}}))((function(e){var t=e.isAuth,n=e.checkAuth,a=e.isLoading;return Object(r.useEffect)((function(){localStorage.getItem("token")&&n()}),[]),a?Object(L.jsx)($,{}):t?Object(L.jsxs)("div",{className:"App",children:[Object(L.jsx)(G,{}),Object(L.jsx)(Y,{})]}):Object(L.jsx)("div",{className:"App",children:Object(L.jsx)(U,{})})})),M=n(7),V={isAuth:null,user:null,isLoading:!1,usersData:null};var ee=n(17),te=n(31),ne=Object(ee.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(M.a)(Object(M.a)({},e),{},{isAuth:t.payload});case g:return Object(M.a)(Object(M.a)({},e),{},{user:t.payload});case O:return Object(M.a)(Object(M.a)({},e),{},{isLoading:t.payload});case x:return Object(M.a)(Object(M.a)({},e),{},{usersData:t.payload});default:return e}}),Object(ee.a)(te.a));s.a.render(Object(L.jsx)(C.a,{store:ne,children:Object(L.jsx)(K,{})}),document.getElementById("root"))},9:function(e,t,n){e.exports={Profile:"Profile_Profile__3b3gY",buttonsContainer:"Profile_buttonsContainer__2wYoS",table:"Profile_table__2ejCI",card:"Profile_card__2jESg",getUsersBtn:"Profile_getUsersBtn__1xQH_"}}},[[81,1,2]]]);
//# sourceMappingURL=main.a7702757.chunk.js.map